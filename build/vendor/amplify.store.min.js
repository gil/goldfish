/*!
 * Amplify Store - Persistent Client-Side Storage @VERSION
 *
 * Copyright 2011 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 *
 * http://amplifyjs.com
 */
(function(p,j){function n(a,d){e.addType(a,function(c,f,b){var g,m=f,h=(new Date).getTime();if(!c){m={};b=[];f=0;try{for(c=d.length;c=d.key(f++);)o.test(c)&&(g=JSON.parse(d.getItem(c)),g.expires&&g.expires<=h?b.push(c):m[c.replace(o,"")]=g.data);for(;c=b.pop();)d.removeItem(c)}catch(k){}return m}c="__amplify__"+c;if(f===j)if(g=(g=d.getItem(c))?JSON.parse(g):{expires:-1},g.expires&&g.expires<=h)d.removeItem(c);else return g.data;else if(null===f)d.removeItem(c);else{g=JSON.stringify({data:f,expires:b.expires?
h+b.expires:null});try{d.setItem(c,g)}catch(l){e[a]();try{d.setItem(c,g)}catch(n){throw e.error();}}}return m})}var e=p.store=function(a,d,c){var b=e.type;c&&(c.type&&c.type in e.types)&&(b=c.type);return e.types[b](a,d,c||{})};e.types={};e.type=null;e.addType=function(a,b){e.type||(e.type=a);e.types[a]=b;e[a]=function(b,d,i){i=i||{};i.type=a;return e(b,d,i)}};e.error=function(){return"amplify.store quota exceeded"};var o=/^__amplify__/,k;for(k in{localStorage:1,sessionStorage:1})try{window[k].setItem("__amplify__",
"x"),window[k].removeItem("__amplify__"),n(k,window[k])}catch(q){}if(!e.types.localStorage&&window.globalStorage)try{n("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===e.type&&(e.type="globalStorage")}catch(r){}a:if(!e.types.localStorage){var b=document.createElement("div");b.style.display="none";document.getElementsByTagName("head")[0].appendChild(b);try{b.addBehavior("#default#userdata"),b.load("amplify")}catch(s){b.parentNode.removeChild(b);break a}e.addType("userData",
function(a,d,c){b.load("amplify");var f,i,g=d,h=(new Date).getTime();if(!a){g={};i=[];for(a=0;d=b.XMLDocument.documentElement.attributes[a++];)f=JSON.parse(d.value),f.expires&&f.expires<=h?i.push(d.name):g[d.name]=f.data;for(;a=i.pop();)b.removeAttribute(a);b.save("amplify");return g}a=a.replace(/[^\-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");a=a.replace(/^-/,"_-");if(d===j)if(f=(d=b.getAttribute(a))?JSON.parse(d):{expires:-1},f.expires&&
f.expires<=h)b.removeAttribute(a);else return f.data;else null===d?b.removeAttribute(a):(i=b.getAttribute(a),f=JSON.stringify({data:d,expires:c.expires?h+c.expires:null}),b.setAttribute(a,f));try{b.save("amplify")}catch(k){null===i?b.removeAttribute(a):b.setAttribute(a,i);e.userData();try{b.setAttribute(a,f),b.save("amplify")}catch(l){throw null===i?b.removeAttribute(a):b.setAttribute(a,i),e.error();}}return g})}var h={},l={};e.addType("memory",function(a,b,c){if(!a)return h===j?j:JSON.parse(JSON.stringify(h));
if(b===j)return h[a]===j?j:JSON.parse(JSON.stringify(h[a]));l[a]&&(clearTimeout(l[a]),delete l[a]);if(null===b)return delete h[a],null;h[a]=b;c.expires&&(l[a]=setTimeout(function(){delete h[a];delete l[a]},c.expires));return b})})(this.amplify=this.amplify||{});